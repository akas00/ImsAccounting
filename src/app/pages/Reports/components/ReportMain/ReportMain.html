<style>
  .Regular {
    font-weight: inherit;
    font-size: inherit;
    height: 20px !important;
    color: inherit;
  }

  .Bold {
    font-weight: bold;
    font-size: inherit;
    height: 23px !important;
    color: inherit;
  }

  .Regulartd {
    white-space: inherit;
    /* height: 17px; */
    line-height: 10px;
    overflow: hidden;
    padding-left: 5px;
    padding-right: 3px
  }

  .Boldtd {
    white-space: inherit;
    /* height: 35px; */
    overflow: hidden;
    padding-left: 5px;
    padding-right: 3px;
    line-height: 10px;
  }

  .toggable-sidebar {
    position: absolute;
    right: -280px;
    transition: 0.3s;
    padding: 10px;
    width: 260px;
    text-decoration: none;
    font-size: 20px;
    border-radius: 0 5px 5px 0;
    background: #c0c0c0;
    color: #000000;
    height: 8%;
    /* width: 20%; */
    margin: 0px;
    border: 1px solid #f1ebeb;
  }

  .mySidenav-show {
    right: 0 !important;
  }

  .btn-toggler {
    position: absolute;
    left: -45px;
    top: 3px;
    background: #8cccfb !important;
    border-color: #8cccfb !important;
    padding: 5px 12px 5px 5px !important;
    font-size: 10px !important;
    width: 45px !important;
  }

  .toggler-btn-icon-reverse {
    transform: rotate(180deg);
  }
.reportFormsFields input{
height: 23px !important;
}
.reportFormsFields select{
height: 32px !important;
}
  .bold_text {
    font-weight: bold;
  }

  .highlighted {
    background: silver;
    color: black;
  }

  .notdisplay {
    display:none;
  }

  .label_size {
    font-size: 12px;
  }
  
  .BoldLarge {
    font-weight: bold;
    font-size: inherit;
    height: 40px !important;
    color: inherit;
  }

  .FinalBoldLarge {
    font-weight: bold;
    font-size: inherit;
    line-height: 40px !important;
    color: inherit;
  }

  .FinalBoldtd {
    white-space: inherit;
    /* height: 35px; */
    overflow: hidden;
    padding-left: 5px;
    padding-right: 3px;
    line-height: 10px;
    font-weight: bold;
  }

  .BoldLargeRed {
    font-weight: bold;
    font-size: inherit;
    height: 40px !important;
    color: red !important;
  }

  .FinalBoldLargeRed {
    font-weight: bold;
    font-size: inherit;
    line-height: 40px !important;
    color: red !important;
  }

  pre{
    color: inherit;
  }

  .noRightBorder {
    border-right:none !important;
  }

  .noLeftBorder {
    border-left:none !important;
  }
  .form-input{
    display: flex;
    align-items: center;
    margin-bottom: 7px;
  }
  .form-input label{
    width: 45%;
  }
  .format-btn{
    margin-right: 7px;
  }
  @media screen and (max-width:991px) {
    .LoadSheetMenus tbody{
      display: flex !important;
      overflow-y: inherit !important;

    }
    .LoadSheetMenus tbody tr{
     
      table-layout: initial !important;

    }
    .table-containerHeight{
      height: 58vh;
    }
    
  }
</style>

<div class="clearfix" style="background: #fff;">
  <div class="col-md-12">
    <label style="font-size:18px;margin-left: 19px; font-family:Roboto, Arial, sans-serif;" class="modal-title bold_text">{{reportDisplayName | titlecase}}&nbsp;&nbsp;</label>
    <ng-container *ngIf="reportparam && reportname">
      <b><label *ngIf="labelDisplayName" class="label_size">{{labelDisplayName}}:&nbsp;</label>
        <label *ngIf="ledgerDisplayName" class="label_size">{{ledgerDisplayName}}&nbsp;&nbsp;</label>
        <label *ngIf="subledgerlabelDisplayName" class="label_size">{{subledgerlabelDisplayName}}:&nbsp;</label>
        <label *ngIf="subledgerDisplayName" class="label_size">{{subledgerDisplayName}}&nbsp;&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="(reportparam.DATE1 || reportparam.DATE2 || reportparam.DATE) && (reportname!='vat register report' && reportname!='vat register report_1')">@As
          On Dated:&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE1 && (reportname!='vat register report' && reportname!='vat register report_1')">{{reportparam.DATE1}}&nbsp;&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE && (reportname!='vat register report' && reportname!='vat register report_1')">{{reportparam.DATE}}&nbsp;&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE2 && (reportname!='vat register report' && reportname!='vat register report_1')">To&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE2 && (reportname!='vat register report' && reportname!='vat register report_1')">{{reportparam.DATE2}}</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE1 && reportparam.DATE2 && (reportname!='vat register report' && reportname!='vat register report_1')">({{FromdateInAD}}
          - {{TodateInAD}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="reportparam.DATE && (reportname!='vat register report' && reportname!='vat register report_1')">({{FromdateInAD}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;" *ngIf="reportmodeisZero == 0">(@As On Dated:</label>&nbsp;<label
          *ngIf="reportmodeisZero == 0">{{reportparam.DATE1}}&nbsp;</label>
        <label  class="label_size" style="font-family:Roboto, Arial, sans-serif;" *ngIf="reportmodeisZero == 0">To&nbsp;</label><label
          *ngIf="reportmodeisZero == 0">{{reportparam.DATE2}}</label>
        <label *ngIf="reportmodeisZero == 0" style="font-family:Roboto, Arial, sans-serif;" class="label_size">({{FromdateInAD}} - {{TodateInAD}}))</label></b>
        <b><label class="label_size" style="width: auto; font-family:Roboto, Arial, sans-serif;"
          *ngIf="divisionDisplayName" >@Division: {{divisionDisplayName}}&nbsp;</label></b>
        <b><label class="label_size" style="width: auto; font-family:Roboto, Arial, sans-serif;"
          *ngIf="costcenterDisplayName" >@Cost Center: {{costcenterDisplayName}}&nbsp;</label></b>
        <!-- <b><label *ngIf="costcenterDisplayName" style="font-family:Roboto, Arial, sans-serif;" class="label_size">@Cost Center:&nbsp;</label><label
            *ngIf="costcenterDisplayName">{{costcenterDisplayName}}</label></b> -->
      <b><label *ngIf="reportmodeisZero == 1" style="font-family:Roboto, Arial, sans-serif;" class="label_size">(@Voucher Range From&nbsp;</label><label
          *ngIf="reportmodeisZero == 1">{{reportparam.FROM_VNO}}</label>
        <label *ngIf="reportmodeisZero == 1" style="font-family:Roboto, Arial, sans-serif;"class="label_size">To</label>&nbsp;<label
          *ngIf="reportmodeisZero == 1">{{reportparam.TO_VNO}})</label></b>
      <b><label *ngIf="detailreportDisplayName" style="font-family:Roboto, Arial, sans-serif;" class="label_size">{{detailreportDisplayName}}</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="accountDisplayName && (reportname=='vat register report' || reportname=='vat register report_1' ||
          this.reportname == 'Cash/Bank Book Report' || this.reportname == 'Cash/Bank Book Report_1' ||this.reportname == 'Cash/Bank Book Report_2')">(@Account:&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="accountDisplayName && (reportname=='vat register report' || reportname=='vat register report_1' ||
          this.reportname == 'Cash/Bank Book Report' || this.reportname == 'Cash/Bank Book Report_1' ||this.reportname == 'Cash/Bank Book Report_2')">{{accountDisplayName}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="entryuserDisplayName && (reportname=='vat register report' || reportname=='vat register report_1' || reportname=='Day Book Report' || reportname=='Day Book Report_1')">(@User:&nbsp;</label>
        <label class="label_size" style="font-family:Roboto, Arial, sans-serif;"
          *ngIf="entryuserDisplayName && (reportname=='vat register report' || reportname=='vat register report_1' || reportname=='Day Book Report' || reportname=='Day Book Report_1')">{{entryuserDisplayName}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;" *ngIf="supplierDisplayName">(@Supplier:&nbsp;</label><label
          *ngIf="supplierDisplayName">{{supplierDisplayName}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;" *ngIf="voucherDisplayName">(@Voucher No:&nbsp;</label><label
          *ngIf="voucherDisplayName">{{voucherDisplayName}})</label></b>
      <b><label class="label_size" style="font-family:Roboto, Arial, sans-serif;" *ngIf="reportTypeDisplay"></label><label
          *ngIf="reportTypeDisplay">{{reportTypeDisplay}}</label></b>
      <b><label class="label_size" style="width: auto; font-family:Roboto, Arial, sans-serif;"
          *ngIf="AreawiseDisplayName" >@Area: {{AreawiseDisplayName}}&nbsp;</label></b>
      <b><label class="label_size" style="width: auto; font-family:Roboto, Arial, sans-serif;"
          *ngIf="PartyGroupDisplayName" >@PartyGroup: {{PartyGroupDisplayName}}&nbsp;</label></b>
      <b><label class="label_size" style="width: auto; font-family:Roboto, Arial, sans-serif;"
          *ngIf="PartyCategoryDisplayName" >@PartyCategory: {{PartyCategoryDisplayName}}&nbsp;</label></b>
   
          
    </ng-container>
    <!-- <ng-container *ngIf="reportname && reportname =='Additional Cost Detail Report'">
      <button type="button" class="btn btn-info" (click)="SaveReport()">Save</button>
    </ng-container> -->
    <button type="button" class="close" data-dismiss="modal" style="margin-right: 3%;margin-top: 5px;"
      (click)="closeReport(this.activeurlpath)">&times;</button>
  </div>
  <div class=" plainBackGround toggable-sidebar" [ngClass]="{ 'mySidenav-show': hideShow }">
    <button class="btn btn-info btn-toggler" (click)="hideShow = !hideShow">
      <span class="glyphicon glyphicon-search"></span>
      <i class=" fa fa-angle-double-left" [ngClass]="{ 'toggler-btn-icon-reverse': hideShow }"></i>
    </button>
    <input class="form-control" style="width: 250px;height:25px;
                  margin-right: 50px;
                  margin-bottom: 10px;" type="text" name="search" [(ngModel)]="filter" placeholder="Search in report">
  </div>
</div>
<div class="clearfix"  style="background: #fff;">
  <div style="float:left;width:3%; margin-left: 10px;">
    <table class="LoadSheetMenus" style="margin-left:-7px; ">
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="fiterClickEvent()" tooltip-placement="right" tooltip="Main filters" style="margin:5px"><span
              class="glyphicon glyphicon-filter" tooltip="Main filters">
            </span></i>
          <span class="cell-comment">
            View Report Dialog Box [F2]
          </span>
        </td>
      </tr>
      <!-- <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;">
          <i (click)="SettingClickEvent()" style="margin:5px"> <span class="glyphicon glyphicon-grain"></span></i>
        </td>
      </tr> -->
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="ExportReportInExcel('xlsx')" style="margin:5px"> <span class="glyphicon glyphicon-export"></span></i>
          <span class="cell-comment">
            Save To Excel [F9]
          </span>
        </td>
      </tr>
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;">
          <i (click)="SaveInReportColumnFormat()" style="margin:5px"> <span
              class="glyphicon glyphicon-tasks"></span></i>
        </td>
      </tr>
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="showPreviouslyLoadedReports()" style="margin:5px"> <span
              class="glyphicon glyphicon-open-file"></span></i>
          <span class="cell-comment">
            Open Report List [Shift+Tab]
          </span>
        </td>
      </tr>
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="printExcelFormat()" style="margin:5px"> <span class="glyphicon glyphicon-print"></span></i>
          <span class="cell-comment">
            Print Excel Format [Shift+P]
          </span>
        </td>
      </tr>
      <tr style="height:30px;width:30px">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="ExportReportInExcel('zip')" style="margin:5px"> <span class="glyphicon glyphicon-download"></span></i>
          <span class="cell-comment">
            Save To Excel in Zip
          </span>
        </td>
      </tr>
      <!-- <tr style="height:30px;width:30px" *ngIf="(reportname == 'Debtors Report' || reportname == 'Debtors Report_1')">
        <td style="border: 1pt solid black;" class="cell-with-comment">
          <i (click)="showcellpayPopup()" style="margin:5px"> <span class="glyphicon glyphicon-hand-right"></span></i>
          <span class="cell-comment">
            Cellpay Payment
          </span>
        </td>
      </tr> -->

    </table>

  </div>
  <div style="float:right;width:96%" class="report-table">
    <div class="widgets">
      <div class="row table-container table-containerHeight">
        <table id="BlueHeaderResizableTable" #reportHtmlTable
          style="font-size:12px; width: 98%;overflow-x :auto;overflow-y :scroll;height:93%;" class="reportTabel">
          <thead *ngIf="optionalreportHeaders.length" style="width: 100%;font-weight: bold;">
            <tr style="height: 25px;">
              <th *ngFor="let column1 of optionalreportHeaders;let id=index" [style.text-align]="column1['alignment']"
                [attr.colspan]="column1.colspan" width="{{column1.width}}" style="font-weight: bold;text-align: center;"
              [ngClass]="(((column1.mappingName=='MAIN GROUP'  || column1.mappingName=='MAINGROUP' || column1.mappingName=='SUB GROUP_A' || column1.mappingName=='SUBGROUP_A' ||
              column1.mappingName=='SUB GROUP_B' || column1.mappingName=='SUBGROUP_B' ||column1.mappingName=='SUB GROUP_C' || column1.mappingName=='SUBGROUP_C' ||
              column1.mappingName=='CATEGORY') && this.reportparam.SHOWGROUPING == 0)?'notdisplay':'') || 
              (((column1.mappingName=='SL_BL' || column1.mappingName=='BL_SL' || column1.mappingName=='SL_BL_A' || column1.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':'')">
              {{column1['colGroup']}}
              </th>
            </tr>

          </thead>
          <thead style="width: 100%;">
              <tr style="height: 25px;">
                <!-- <th *ngIf="(reportname == 'Debtors Report' || reportname == 'Debtors Report_1') && mergereportHeaders.length" style="width: 20px;"></th> -->
                <th *ngFor="let column1 of mergereportHeaders;let i=index" style="font-weight: bold;text-align: center;"
                  width="{{column1.width}}" [ngStyle]="getReportHeadingStyles()" [ngClass]="[(((column1.mappingName=='MAIN GROUP'  || column1.mappingName=='MAINGROUP' || column1.mappingName=='SUB GROUP_A' || column1.mappingName=='SUBGROUP_A' ||
                                          column1.mappingName=='SUB GROUP_B' || column1.mappingName=='SUBGROUP_B' ||column1.mappingName=='SUB GROUP_C' || column1.mappingName=='SUBGROUP_C' ||
                                          column1.mappingName=='CATEGORY') && this.reportparam.SHOWGROUPING == 0)?'notdisplay':'') || 
                                          (((column1.mappingName=='SL_BL' || column1.mappingName=='BL_SL' || column1.mappingName=='SL_BL_A' || column1.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':''),
                                          (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0? ((i+1 == 2 || i+1 == 3 || i+1 == 4) ? 'noRightBorder':'') : '',
                                          (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0? ((i+1 == 3 || i+1 == 4 || i+1 == 5) ? 'noLeftBorder':'') : '',
                                          (reportname == 'PLACCOUNT' || reportname=='BALANCESHEET') && ShowLineInFinalReport==0 ? ((i+1 == 1 || i+1 == 2 || i+1 == 3 || i+1 == 7 || i+1 == 8 || i+1 == 9) ? 'noRightBorder':'') : '',
                                          (reportname == 'PLACCOUNT' || reportname=='BALANCESHEET') && ShowLineInFinalReport==0 ? ((i+1 == 2 || i+1 == 3 || i+1 == 4 || i+1 == 8 || i+1 == 9 || i+1 == 10) ? 'noLeftBorder':'') : ''
                                          ]">
                  {{column1.colHeader}}
                </th>
              </tr>
          </thead>
            <tbody style="width: fit-content;" #body>
              <ng-container *ngIf="reportname!='PLACCOUNT' && reportname!='BALANCESHEET'">
                <tr
                *ngFor=" let data of reportData | filter:filter | paginate: { itemsPerPage: rowsperpage, currentPage: p };let i=index"
                (dblclick)="drillDownReport(data)" (contextmenu)="onRightClick($event,data)"
                [ngClass]="[data.FFLG=='B'?'Bold':'Regular',data.FFLG=='BL'?'BoldLarge':'Regular',data.FFLG=='BR'?'BoldLargeRed':'Regular']" [class.active]="i == HighlightRow" (click)="clicked(i)">
  <!-- <td *ngIf="(reportname == 'Debtors Report' || reportname == 'Debtors Report_1') && reportData.length" style="width: 20px;">
    <input type="checkbox" [(ngModel)]="data.isCheck" (change)="checkData(i,data)">
  </td> -->
                <td [ngClass]="[(data.FFLG=='B')? 'Boldtd':'Regulartd' , 
                (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0 ? ((id+1 == 2 || id+1 == 3 || id+1 == 4) ? 'noRightBorder':'') : '',
                (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0? ((id+1 == 3 || id+1 == 4 || id+1 == 5) ? 'noLeftBorder':'') : '',
                (((column.mappingName=='MAIN GROUP' || column.mappingName=='MAINGROUP' || column.mappingName=='SUB GROUP_A' || 
                column.mappingName=='SUBGROUP_A' || column.mappingName=='SUB GROUP_B' || column.mappingName=='SUBGROUP_B' ||column.mappingName=='SUB GROUP_C' || 
                column.mappingName=='SUBGROUP_C' ||
                column.mappingName=='CATEGORY')  && this.reportparam.SHOWGROUPING == 0)? 'notdisplay':'') || 
                (((column.mappingName=='SL_BL' || column.mappingName=='BL_SL' || column.mappingName=='SL_BL_A' || column.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':'')

                ]"
                 *ngFor="let column of reportHeaders;let id=index"
                  width="{{column.width}}" [style.text-align]="column.alignment==0?'inherit':'end'" style="height: 20px !important;">
   
                   <pre style="margin: 0 !important;overflow: hidden;" [ngStyle]="getReportDetailStyles()">{{data[column.mappingName]}}</pre>
                   </td>
              </tr>
              </ng-container>
              <ng-container *ngIf="reportname=='PLACCOUNT' || reportname=='BALANCESHEET'">
                <tr style="width:100%;"
                *ngFor=" let data of reportData | filter:filter | paginate: { itemsPerPage: rowsperpage, currentPage: p };let i=index"
                (dblclick)="drillDownReport(data)" (contextmenu)="onRightClick($event,data)" [class.active]="i == HighlightRow" >
                <ng-container *ngFor="let column of reportHeaders;let j=index">
                  <td [ngClass]="[(data.FFLG1=='B')? 'FinalBoldtd':'Regulartd' ,(data.FFLG1=='BL')? 'FinalBoldLarge':'Regulartd',(data.FFLG1=='BR')? 'FinalBoldLargeRed':'Regulartd',
                   (((column.mappingName=='MAIN GROUP' || column.mappingName=='MAINGROUP' || column.mappingName=='SUB GROUP_A' || 
                  column.mappingName=='SUBGROUP_A' || column.mappingName=='SUB GROUP_B' || column.mappingName=='SUBGROUP_B' ||column.mappingName=='SUB GROUP_C' || 
                  column.mappingName=='SUBGROUP_C' ||
                  column.mappingName=='CATEGORY')  && this.reportparam.SHOWGROUPING == 0)? 'notdisplay':'') ||
                  (((column.mappingName=='SL_BL' || column.mappingName=='BL_SL' || column.mappingName=='SL_BL_A' || column.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':''),
                  ((j+1 == 1 || j+1 == 2 || j+1 == 3) && ShowLineInFinalReport==0 ? 'noRightBorder':''),
                  ((j+1 == 2 || j+1 == 3 || j+1 == 4) && ShowLineInFinalReport==0? 'noLeftBorder':''),
                  ((j+1 == 7 || j+1 == 8 || j+1 == 9) && ShowLineInFinalReport==0? 'noRightBorder':''),
                  ((j+1 == 8 || j+1 == 9 || j+1 == 10) && ShowLineInFinalReport==0? 'noLeftBorder':'')
                  ]"
                   *ngIf="j+1<=leftcolumnnumber+1"
                    width="{{column.width}}" [style.text-align]="column.alignment==0?'inherit':'end'" style="height: 20px !important;" (click)="clickedPL(j,column)">
     
                     <pre style="margin: 0 !important;overflow: hidden;" [ngStyle]="getReportDetailStyles()">{{data[column.mappingName]}}</pre>
                     </td>
                </ng-container>
                <ng-container *ngFor="let column of reportHeaders;let k=index">
                  <td [ngClass]="[(data.FFLG2=='B')? 'FinalBoldtd':'Regulartd' ,(data.FFLG2=='BL')? 'FinalBoldLarge':'Regulartd',(data.FFLG2=='BR')? 'FinalBoldLargeRed':'Regulartd',
                   (((column.mappingName=='MAIN GROUP' || column.mappingName=='MAINGROUP' || column.mappingName=='SUB GROUP_A' || 
                  column.mappingName=='SUBGROUP_A' || column.mappingName=='SUB GROUP_B' || column.mappingName=='SUBGROUP_B' ||column.mappingName=='SUB GROUP_C' || 
                  column.mappingName=='SUBGROUP_C' ||
                  column.mappingName=='CATEGORY')  && this.reportparam.SHOWGROUPING == 0)? 'notdisplay':'') ||
                  (((column.mappingName=='SL_BL' || column.mappingName=='BL_SL' || column.mappingName=='SL_BL_A' || column.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':''),
                  ((k+1 == 1 || k+1 == 2 || k+1 == 3) && ShowLineInFinalReport==0? 'noRightBorder':''),
                  ((k+1 == 2 || k+1 == 3 || k+1 == 4) && ShowLineInFinalReport==0? 'noLeftBorder':''),
                  ((k+1 == 7 || k+1 == 8 || k+1 == 9) && ShowLineInFinalReport==0? 'noRightBorder':''),
                  ((k+1 == 8 || k+1 == 9 || k+1 == 10) && ShowLineInFinalReport==0? 'noLeftBorder':'')
                  ]"
                   *ngIf="k+1 >= rightcolumnnumber"
                    width="{{column.width}}" [style.text-align]="column.alignment==0?'inherit':'end'" style="height: 20px !important;">
     
                     <pre style="margin: 0 !important;overflow: hidden;  " [ngStyle]="getReportDetailStyles()">{{data[column.mappingName]}}</pre>
                     </td>
                </ng-container>
               
              </tr>
              </ng-container>
 
            </tbody>
       
          <tfoot style="margin-bottom: 0.5%;width: 100%;">
            <tr *ngFor=" let data of reportFooter"
              style="font-weight: bold;font-size: inherit;height: 20px !important;color: inherit;">
              <!-- <td *ngIf="(reportname == 'Debtors Report' || reportname == 'Debtors Report_1') && reportFooter.length" style="height: 30px !important;background: #ABDCFB;width: 20px;">
              </td> -->
              <td *ngFor="let column of reportHeaders;let i=index" width="{{column.width}}"
                [style.text-align]="column.alignment==0?'inherit':'end'"
                 style="height: 30px !important;background: #ABDCFB;"
                  [ngClass]="[(((column.mappingName=='MAIN GROUP'  || column.mappingName=='MAINGROUP' || column.mappingName=='SUB GROUP_A' || column.mappingName=='SUBGROUP_A' ||
                  column.mappingName=='SUB GROUP_B' || column.mappingName=='SUBGROUP_B' ||column.mappingName=='SUB GROUP_C' || column.mappingName=='SUBGROUP_C' ||
                  column.mappingName=='CATEGORY') && this.reportparam.SHOWGROUPING == 0)?'notdisplay':'') || 
                  (((column.mappingName=='SL_BL' || column.mappingName=='BL_SL' || column.mappingName=='SL_BL_A' || column.mappingName=='BL_SL_A') && this.reportparam.SHOWSUBLEDGER == 0)?'notdisplay':''),
                  (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0 ? ((i+1 == 2 || i+1 == 3 || i+1 == 4) ? 'noRightBorder':'') : '',
                  (reportname=='Profit Loss Report' || reportname=='Balance Sheet Report') && ShowLineInFinalReport==0 ? ((i+1 == 3 || i+1 == 4 || i+1 == 5) ? 'noLeftBorder':'') : '',
                  (reportname == 'PLACCOUNT' || reportname=='BALANCESHEET') && ShowLineInFinalReport==0 ? ((i+1 == 1 || i+1 == 2 || i+1 == 3 || i+1 == 7 || i+1 == 8 || i+1 == 9) ? 'noRightBorder':'') : '',
                  (reportname == 'PLACCOUNT' || reportname=='BALANCESHEET') && ShowLineInFinalReport==0 ? ((i+1 == 2 || i+1 == 3 || i+1 == 4 || i+1 == 8 || i+1 == 9 || i+1 == 10) ? 'noLeftBorder':'') : ''
                  ]">
                  <pre style="margin: 0 !important;overflow: hidden; "
                   [ngStyle]="getReportFooterStyles()">{{data[column.mappingName]}}</pre>
                  </td>
            </tr>
          </tfoot>
          <div>
            <!-- <div style="margin-left: 455px;">
              <label>Rows Per Page:</label>
              <input type="number" style="width: 5%;" [(ngModel)]="rowsperpage"  >
            </div> -->
            <div style="text-align: center;margin-bottom: -14px;">
              <pagination-controls (pageChange)="p = $event" (click)="clickNext()"></pagination-controls>
            </div>
          </div>


        </table>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" bsModal #childModal="bs-modal" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" (click)="this.childModal.hide()">&times;</button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body">
        {{DialogMessage}}
      </div>
    </div>
  </div>
</div>

<div class="modal-sticky" *ngIf="showReportColumnFormatPopup"
  style="overflow: auto;right: 5%;width: 90%;z-index: 9999999">

  <div class="modal-content modal-content-main-area reportFormsFields">

    <div class="row" style="display: flex; margin: 10px 0px;">
      <div class="col-md-2">
        <h4 class="modal-title" id="myModalLabel">Report Format </h4>
      </div>
      <div class="col-lg-10" style="display: flex; justify-content: right;">
        <div class="format-btn"*ngIf="ReportColumnName.length > 0" >
          <button type="button" class="btn btn-primary" (click)="refreshReportColumns()">Refresh</button>
        </div>

        <div class="format-btn">
          <button type="button" class="btn btn-primary" (click)="exportReportFormat()">Export Format</button>
        </div>
        <div class="format-btn" >
          <button type="button" class="btn btn-primary" (click)="OkCommand()">Save</button>
        </div>
        
        <div class="format-btn" >
          <button type="button" class="btn btn-primary" (click)="CancelCommand()">Cancel</button>
        </div>

      </div>

    </div>
    <div  style=" margin-top: 5px; margin-bottom: 15px; display:flex; ">
      
     
      <div class="col-md-12">
        <div class="row" style="display:flex">
          <div class="col-lg-4">
            <div class="form-input">
              <label class=" label">Report Name</label>
             <div >
            <input type="text" class="form-control" [readonly]="true" style="color: black;" [(ngModel)]="reportname">
          </div>
            </div>
            <div class="form-input">
              <label class=" label" >Report Title</label>
              <div >
                <input type="text" class="form-control" [(ngModel)]="reportTitle" >
              </div>

            </div>
            <div class="form-input">
              <label class=" label">Rows Per Column</label>
              <div >
                <input type="text" class="form-control" [(ngModel)]="rowsperpage" >
              </div>
            </div>
            <div class="form-input">
              <label class=" label" >Has Dynamic Columns?</label>
              <div class="">
                <select name="dynamic" id="dynamiccolumn" [(ngModel)]="hasDynamicColumns" class="form-control" style="padding:0 !important; height:23px !important; font-size: 12px !important;">
                  <option value="1">YES</option>
                  <option value="0">NO</option>
                </select>
              </div>
            </div>

          </div>
          <div class="col-lg-4">
            <div class="form-input">
              <label class=" label" >Has Dynamic Headers?</label>
              <div class="">
                <select name="dynamicheaders" id="dynamicheader" [(ngModel)]="hasDynamicHeaders" class="form-control input-text-element" style=" height:23px !important;padding:0 !important; font-size: 12px !important;">
                  <option value=1>YES</option>
                  <option value=0>NO</option>
                </select>
              </div>
              
            </div>
            <div class="form-input">
              <label class=" label" style=" white-space: nowrap;">Dynamic Column Level</label>
              <div class="">
                <input type="number" class="form-control" [(ngModel)]="dynamicColumnLevel"
                 
                >
  
              </div>
              
            </div>
            <div class="form-input">
              <label class=" label" style=" white-space: nowrap;">Dynamic Column Width</label>
              <div class="">
                <input type="text" class="form-control" [(ngModel)]="dynamicColumnWidth"
                >
  
              </div>
              
            </div>
            <div class="form-input">
              <label class=" label" style="white-space: nowrap;">Left Columns</label>
              <div class="">
                <input type="text" class="form-control" [(ngModel)]="leftcolumnnumber" >
              </div>
              
            </div>
          </div>

          <div class="col-lg-4">
            <div class="form-input">
              <label class=" label" style="white-space: nowrap;">Right Columns</label>
              <div class="">
                <input type="text" class="form-control" [(ngModel)]="rightcolumnnumber" >
              </div>

            </div>
            <div class="form-input">
              <label class=" label">Merge Header?</label>
              <div class="">
                <select name="mergeheader" id="_mergeheader" [(ngModel)]="MergeReportHeader" class="form-control" 
                style=" height:23px !important; font-size: 12px !important; padding:0 !important;">
                  <option value=1>YES</option>
                  <option value=0>NO</option>
                </select>
              </div>
              
            </div>
            <div class="form-input">
              <label class=" label" style="white-space: nowrap;">Show Line in Final Reports?</label>
              <div class="">
                <select name="lineinfinalreports" id="_showline" [(ngModel)]="ShowLineInFinalReport" class="form-control input-text-element" style="font-size: 11px; height: 23px !important; padding:0 !important;">
                  <option value=1>YES</option>
                  <option value=0>NO</option>
                </select>
              </div>
              
            </div>

          </div>

        </div>
       
      </div>

    </div>
    
    <div class="table-responsive">

      <table class="table" style="display: grid;">
        <thead>
          <tr>
            <th style="width: 55px; ">SI NO </th>
            <th scope="col" style="width: 190px; ">Column Name</th>
            <th scope="col" style="width: 190px; ">Mapping Name</th>
            <th scope="col" style="width: 60px; ">Show</th>
            <th scope="col" style="width: 90px; ">Col Width</th>
            <th scope="col" style="width: 100px; ">Format</th>
            <th scope="col" style="width: 75px; ">Align</th>
            <th scope="col" style="width: 120px; ">Column Position</th>
            <th scope="col" style="width: 120px; ">Merge Header</th>
            <th scope="col" style="width: 120px; ">Group Summary</th>
            <!-- <th scope="col" style="width: 140px; ">GS Function</th> -->
            <th scope="col" style="width: 120px; ">Table Summary</th>
            <!-- <th scope="col" style="width: 140px; ">TS Function</th> -->
          </tr>
        </thead>
        <tbody>
          <tr *ngFor=" let column of ReportColumnName; let i= index ;">
            <td style="width: 55px; ">{{i+1}}</td>
            <!-- input type="checkbox" name="mergeVat" (change)="$event.target.checked?(ReportParameters.MergeVatAc=1):(ReportParameters.MergeVatAc=0)" [checked]="ReportParameters.MergeVatAc == 1" -->
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="column.ColumnName">
            </td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" class="form-control" [readonly]="true"
                style="color: black;height:26px;margin-top: 2px;" [(ngModel)]="column.MappingName">
            </td>
            <td style="width: 60px;line-height: 32px; ">
              <input type="checkbox" class="form-control" style="height:26px;margin-top: 2px;"
                (change)="column.Show = $event.target.checked?1:0" [(ngModel)]="column.Show">
            </td>
            <td style="width: 90px;line-height: 32px; ">
              <input type="number" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="column.ColWidth">
            </td>
            <td style="width: 100px;line-height: 32px; ">
              <input type="text" class="form-control" style="height:26px;margin-top: 2px;" [(ngModel)]="column.Format">
            </td>
            <td style="width: 75px;line-height: 32px; ">
              <input type="number" class="form-control" style="height:26px;margin-top: 2px;" [(ngModel)]="column.Align">
            </td>
            <td style="width: 120px;line-height: 32px; ">
              <input type="number" class="form-control" style="height:26px;margin-top: 2px;"
                [(ngModel)]="column.ColumnPosition">
            </td>
            <td style="width: 120px;line-height: 32px; ">
              <input type="text" class="form-control" style="height:26px;margin-top: 2px;"
                [(ngModel)]="column.ColGroup">
            </td>
            <td style="width: 120px;line-height: 32px; ">
              <input type="checkbox" class="form-control" (change)="column.GroupSummary = $event.target.checked?1:0"
                style="height:26px;margin-top: 2px;" [(ngModel)]="column.GroupSummary">
            </td>
            <!-- <td style="width: 140px; "><input type="text" class="form-control" [(ngModel)]="column.GSFunction"></td> -->
            <td style="width: 120px;line-height: 32px; ">
              <input type="checkbox" (change)="column.TableSummary = $event.target.checked?1:0" class="form-control"
                style="height:26px;margin-top: 2px;" [(ngModel)]="column.TableSummary">
            </td>
            <!-- <td style="width: 140px; "><input type="text" class="form-control" [(ngModel)]="column.TSFunction"></td> -->
          </tr>

        </tbody>
      </table>

    </div>

    <!-- <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="OkCommand()">Save</button>

      <button type="button" class="btn btn-primary" (click)="CancelCommand()">Cancel</button>
    </div> -->
  </div>

</div>

<div class="modal-sticky" *ngIf="showReportListDialog" style="overflow: auto;right: 40%;width: 30%;z-index: 9999999">

  <div class="modal-content modal-content-main-area" #datatable>
    <div style="height: 28px; margin-top: 5px; ">
      <div class="col-md-12">
        <h4 class="modal-title" id="myModalLabel">Loaded Report List</h4>
      </div>

    </div>
    <div class="table-responsive">

      <table class="table" style="display: grid;">
        <thead>
          <tr>
            <th style="width: 10px; ">S.N.</th>
            <th>Report Name</th>
            <!-- <th style="width: 1%;" ></th> -->

          </tr>
        </thead>
        <tbody>
          <tr *ngFor=" let column of previouslyLoadedReportsList; let i= index ;"
            (click)="onClickLoadedReportList(i,column)" [class.highlighted]="i === selectedRowIndex">
            <td style="width: 52px; ">{{i+1}}</td>
            <td #reportnameinlist id="reportname{{i}}">{{column.reportname}}</td>
            <!-- <td style="width: 1%; cursor: pointer;" (click)="popReportandClose(column.activeurlpath)">&times;</td> -->
          </tr>

        </tbody>
      </table>

    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="CancelReportList()">Cancel</button>
    </div>
  </div>

</div>

<!-- cellpay payment voucher list -->

<div class="modal-sticky" *ngIf="showCellPayPaymentPopup"
  style="overflow: auto;right: 5%;width: 90%;z-index: 9999999">

  <div class="modal-content modal-content-main-area">
    <div style="height: 28px; margin-top: 5px; ">
      <div class="col-md-2">
        <h4 class="modal-title" id="myModalLabel">Cellpay Payment</h4>
      </div>
      <div class="col-md-12">
        <div style="display: flex;">
        <div class="row">
          <label class="col-md-4 label" style="margin-top: 4px;width: 137px;">Voucher No</label>
          <div class="col-md-3" style="width:55%;margin-left:4px;">

            <input type="text" class="form-control" [readonly]="true" style="color: black;width: 195px;" [(ngModel)]="this._trnMainService.TrnMainObj.VCHRNO" disabled>
          </div>
        </div>

        <div class="row" style="margin-top:-21px;margin-left: 112px;">
          <button type="button" class="btn btn-primary" (click)="OkCellpayCommand()">Save</button>
        </div>
        
        <div class="row" style="margin-top:-21px;margin-left:28px">
          <button type="button" class="btn btn-primary" (click)="CancelCellpayCommand()">Cancel</button>
        </div>
        </div>
      </div>
      <div class="col-md-12">
        <div style="display: flex;">
        <div class="row">
          <label class="col-md-4 label" style="margin-top: 4px;width: 137px;">Payment Mode</label>
          <div class="col-md-3" style="width:55%;margin-left:4px;">
            <input type="text" class="form-control" [readonly]="true" style="color: black;width: 195px;" [(ngModel)]="this._trnMainService.TrnMainObj.TRNMODE">
          </div>
        </div>
        <div class="row">
          <label class="col-md-4 label" style="margin-top: 4px;width: 137px;">Cash/Bank</label>
          <div class="col-md-3" style="width:55%;margin-left:4px;">
            <!-- <input type="text" class="form-control" [readonly]="true" style="color: black;width: 195px;" [(ngModel)]="this._trnMainService.TrnMainObj.TRNMODE"> -->
            <input type="text"  class="form-control" [(ngModel)]="_trnMainService.TrnMainObj.TRNACName" name="TRNAC" 
              autocomplete="off" placeholder="press ENTER to Select A/C" (keydown.Enter)="showAcPartyList()" />
          </div>
        </div>
        </div>
      </div>

    </div>
    <div class="table-responsive">

      <table class="table" style="display: grid;">
        <thead>
          <tr>
            <th style="width: 55px; ">SNO </th>
            <th scope="col" style="width: 190px; ">Ledger</th>
            <th scope="col" style="width: 190px; ">Amount</th>
            <th scope="col" style="width: 190px; ">Narration</th>
            <th scope="col" style="width: 190px; ">Bank Code</th>
            <th scope="col" style="width: 190px; ">Bank Name</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor=" let data of this._trnMainService.TrnMainObj.TrntranList; let i= index ;">
            <td style="width: 55px; ">{{i+1}}</td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="data.acitem.ACNAME" disabled>
            </td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="data.DRAMNT" (change)="AddCellPayFee()" [disabled]="data.disableCellPayRow == true">
            </td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="data.NARATION" [disabled]="data.disableCellPayRow == true">
            </td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="data.ChequeNo" [disabled]="data.disableCellPayRow == true">
            </td>
            <td style="width: 190px;line-height: 32px; ">
              <input type="text" style="height:26px;margin-top: 2px;" class="form-control"
                [(ngModel)]="data.BANKNAME" (keyup.Enter)="AddCellPayFee()" [disabled]="data.disableCellPayRow == true">
            </td>
          </tr>

        </tbody>
      </table>

    </div>
  </div>

</div>
<!-- cellpaypayment end -->


<div *ngIf="contextMenuView.show==true">
  <app-contextmenu [data]="contextMenuView"></app-contextmenu>
</div>


<generic-popup-grid #genericGridACListParty [popupsettings]="gridACListPartyPopupSettings"
  (onItemDoubleClick)="onAcPartySelect($event)"></generic-popup-grid>